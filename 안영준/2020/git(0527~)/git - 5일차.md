# git - 5일차		

**git 객체 모델과 파일에 대한 자세한 설명**

최초파일과 객체 =  작업 디렉터리에 있는 file1, file2가 있다고 할 경우 저 두 파일과 관련있는 master 브랜치에는 file1가 file2의 콘텐츠와 완전히 동일한 a, b 라는 트리를 기록하는 커밋이있다.

그리고 인덱스에는 두파일에대해 SHA1값을 각각 기록한다. 작업 디렉터리와 인덱스, 그리고 객체 저장소는 모두 동기화되어 수정된 것이없다.

만약 파일1을 편집하면 작업디렉터리만 수정된 것으로 간주한다.

git add file1 명령을 사용해서 file2를 준비 사태로 설정하지않았기 때문에 인덱스는 file2만 계속해서 blob파일을 참조하는 것을 알 수있다.

이시점에서 file1은 인덱스에 준비상태로 설정되어있고 인덱스만 수정한것으로 간주된다.



1. 인덱스 트리 객체 변환 -> 2.커미 객체 생성 -> 3. 브랜치 참조 업데이트

#### chapter6 커밋

커밋이 발생하면 인덱스의 스냅샷을 기록해서 객체 저장소에 저장한다. git 에서는 인덱스에 있는 파일의 스냅샷과 이전 스냅샷을 비교하여 영향을 받은 파일과 디렉터리 목록을 뽑아냄.

**원자적 변경 세트**

모든 커밋은 이전 상태와 관련된 원자적 변경 세트를 나타낸다. 

커밋 스내샷은 수정된 파일을 모두 포함하고 있는 세트라고 할 수 있으며, 하나의 트리 상태를 나타내야 한다.

그리고 스냅샷 간의 변화는 트리 대 트리 변화를 나타낸다. 

git에서는 파일의 변경 이유를 고려하지 않음. 즉 변경 사항의 콘텐츠는 문제가 되지 않는다.

파일을 한 위치에서 다른 위치로 이동하는 작업을 수행할 경우 단일 동작으로 처리 가능하다.

그럼에도 중요한 이유는 베스트 프랙티스에 따라 좀 더 적절하게 커밋을  구조화할수 있기 때문이다.

**커밋 식별하기**

코드를 비교하려면 두개의 커밋을 지정해야 하며, 커밋 히스토리를 편집하려면 커밋 모음을 제공해야 한다.

git에서는 명시적, 묵시적 참조를 통하여 각각의 커밋을 참조 할 수 있다.

SHA1 커밋 ID는 명시적 참조인 반면 항상 최신 커밋을 가르키는 HEAD는 묵시적 참조이다. 

**절대적 커밋 이름**

커밋과 관련하여 가장 엄격한 이름은 해시ID이다. 해시ID는 절대적인 이름이고 ,이는 정화히 하나의 커밋만을  참조 할수 있다는 것을 의미한다. 따라서 커밋이 저네 저장소 히스토리의 어디에 있는지는 문제되지않는다. 

각 커밋은 전역적으로 모든 저장소에서도 고유하다. 예를 들어 커밋ID가 있는 컴퓨터에 동일한 커밋ID를 받으면 동일한 커밋을 가지고 있다는 것을 확신 할 수 있다.

**참조와 심볼릭 참조**

참조는 Git 객체 저장소 내에 있는 객체를 참조하는 SHA1 해시 ID이다. 참조는 모든 GIt 객체를 참조할 수 있지만, 대개는 커밋 객체를 참조한다, 심볼릭 참조는 간접적으로 Git객체를 가리키는이름이며, 이 또한 참조에 해당한다.

로컬 토픽 브랜치 이름, 원격 추적 브랜치 이름 도 모두 참조이다.



심볼릭 참조는 refs/로 시작하는 명시적인 전체이름을 가지고 있으며, 저장소의 .git/refs/디렉터리 내에 계층적으로 저장된다.



로컬 브랜치용으로 refs/heads/ref , 원격 추정 브랜치용 refs/remotes/ref 및 태그에서 사용되는 refs/tags/ref라는 기본 네임스페이스가 있다.



전체참조이름이나 약식 이름중 원하는 이름을 사용할 수 있지만, 이름이 같은 브랜치, 태그가 있을경우 휴리스틱 기법을 적용하여 git rev-parse 맨페이지의 다음 목록에 따라 처음이 일치하는 항복 사용함.



HEAD = 최신 커밋 참조

ORIG_HEAD = 병합 및 재설정과 같은 특정 작업에서는 HEAD를 새값으로 조정되기 전까지 이전버전의 HEAD를 저장함.

FETCH_HEAD = 원격저장소를 사용하는 경우 git fetch 명령은 가져온 모든 브랜치의 헤드를 저장함.

마지막 브랜치의 헤드를 의미하는 약어로 패치작업 직후에만 유효함.

MERGE_HEAD = 병합 작업하면 다른 브랜치의 헤더가 심볼릭 참조 MERGE_HEAD에 임시로 기록된다.



