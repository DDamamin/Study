#### 스마트 케스트: 타입 검사와 타입 캐스트를 조합

간단한 산술식을 계산하는 함수를 만들어보자.

식을 트리 구조로 저장하고, 노드는 합계나 수 중 하나다. 수는 항상 말단노드지만, 합계는 자식이 둘 있는 중간노드이다.  합계노드의 두 자식은 덧셈의 두 인자다. 클래스가 구현하는 인터페이스를 지정하기 위해서는 클론 뒤에 인터페이스 이름을 사용하면된다.

interface Expr

class Num(val value: Int) : Expr

class Sum(val left:expr, val right: Expr) : Expr

Expr 인터페이스는 두 가지 구현 클래스가 존재한다. 따라서 식을 평가하려면 두 가지 경우를 고려해야된다.

1. 어떤 식이 수라면 그 값을 반환한다.
2. 어떤 식이 합계라면 좌항과 우항의 값을 계싼한 다음에 그 두값을 합한 값을 반환한다.

코틀린에서는 is를 사용해 변수 타입을 검사한다. is검사는 자바의 instanceof와 비슷하다. 하지만 자바에서 어떤 변수의 타입을 instanceof로 확인한 다음에 그 속한 멤버에 접근하기 위해서는 명시적으로 변수 타입을 캐스팅해야된다. 이런 멤버 접근을 여러번 수행해야한다면 변수가 따로 캐스팅 결과를 저장한 후 사용해야한다.  그에 비해 코틀린의 is는 변수를 원하는 타입으로 캐스팅하지 않아도 사용할수 있다. 하지만 실제로는 컴파일러가 캐스팅을 수행해주며, 이를 캐스트라고 한다.

if(e is Num){}

스마트 캐스트는 is로 변수에 든 값의 타입을 검사한 다음 그 값이 바뀔 수 없을 경우에만 적용이된다. val이 아니거나 val이지만 커스텀 접근자를 사용하는 경우에는 해당 프로퍼티에 대한 접근이 항상 같은 값을 내놓는다고 확신할수없기 떄문이다. 원하는 타입을 명시적으로 타임캐스팅하려면 as키워드를 사용해야한다.

