# Notion 투표 템플릿 만들기
  
**출처**  
<a href = "https://romantech.net/1054" target = "_blank">로맨테크</a>  
  
## 설정 방법
  
1. `/table`을 입력하여 Table 포맷의 Database 생성  
![생성화면](https://user-images.githubusercontent.com/51042546/78515294-47485300-77f0-11ea-8431-6067bf7c12ec.JPG)  
  
2. 투표 항목과 투표자, 득표수 속성을 추가한다. (물론 기타 속성도 마음대로 추가할 수 있다.)  
![속성 추가](https://user-images.githubusercontent.com/51042546/78515633-81febb00-77f1-11ea-9b46-3e603718b5e3.JPG)  
  
3. 득표수 아래에 다음과 같은 수식을 넣는다.  
  
    if(empty(prop("투표자")), "0", format(length(replaceAll(prop("투표자"), "[^,]", "")) + 1))
  
## 수식 설명
  
### prop
  
특정 속성의 값을 반환해주는 함수로, `prop("속성명")`의 형식으로 하면 해당 속성의 값을 가져올 수 있다.  
![prop](https://user-images.githubusercontent.com/51042546/78515966-ca6aa880-77f2-11ea-9167-a841c6ede8c3.JPG)  
  
(심지어 선택 가능한 다양한 수식들을 한 번에 보여주고 예시도 보여줘서 편리하다.) 우리는 투표자의 수를 구해야 한다. 그런데 해당 속성에 복수 개의 정보가 있을 경우 `,`로 구분된다. 즉, 해당 속성 개수는 `, 개수 + 1개` 라는 뜻이 된다.
  
### replaceAll
  
![replaceAll](https://user-images.githubusercontent.com/51042546/78516026-1ae20600-77f3-11ea-94aa-41c0dd3cee6c.JPG)  
  
특정 문자열에서 내가 원하는 문자열만 원하는 문자열로 바꿀 수 있다.  
그러므로 우리는 투표자에서 ,만 구할 수 있다는 말이다.  
  
    replaceAll(prop("투표자"), "[^,]", "")
  
"[^,]"는 정규 표현식으로 특정한 규칙을 가진 문자열들을 하나의 집합으로 표현할 수 있는 식이다. 다음과 같이 표현할 경우 ,를 제외한 모든 문자열이 빈 문자열 처리가 된다.  
  
즉, 남은 문자열에는 ,만 남게 된다.  
  
### lenght
  
속성의 길이를 반환해주는 함수이다. 아까 replaceAll에서 구한 ,를 통해 ,의 개수를 반환받을 수 있다. 물론 투표자는 ,의 개수 + 1 이므로 lenght에서 반환한 값에 1을 더해줘야 한다.  
  
    lenght(replaceAll(prop("투표자"), "[^,]", "")) + 1
  
### if
  
그런데 문제가 있다. 투표를 아무도 하지 않은 상태도, 한 명만 투표한 상태도 모두 ,의 개수가 0이라서 모두 1로 표시된다는 점이다. 투표를 아무도 하지 않았다면 0으로 표시하기 위해 if 조건문을 활용한다.  
  
    if(empty(prop("투표자")), "참일 때 문자열", "거짓일 때 문자열")
  
다음과 같이 if는 조건식, 참일 때 출력할 문자열, 거짓일 때 출력할 문자열 순으로 인수를 전달받는다.  
  
조건식인 `empty(prop("투표자"))`는 말 그대로 투표자 항목이 비어있을 때를 말한다.  
  
이 조건이 만약 참이라면 일단 0을 출력하기로 한다. 그렇다면 다음과 같이 작성한다.  
  
    if(empty(prop("투표자")), "0", "거짓일 때 문자열")
  
거짓일 때가 문제인데, 우리는 lenght 함수로 구한 수를 출력하고 싶지만 정수는 문자열 형태가 아니라서 그냥 쓰면 에러가 나게 된다. 그래서 텍스트 포맷으로 변환시켜주는 format 함수를 사용한다.  
  
    if(empty(prop("투표자")), "0", format(lenght(replaceAll(prop("투표자"), "[^,]", "")) + 1))
  
이렇게 하면 아무도 투표하지 않은 상태일 때는 0을, 투표한 사람이 한 명이라도 있을 때는 투표자 수만큼 수를 출력하게 된다.  
  
## 완성 이미지
  
![결과](https://user-images.githubusercontent.com/51042546/78516596-19b1d880-77f5-11ea-980c-458cba6df474.JPG)  
  
누가 투표했는지 알 수 있지만 비밀 투표가 보장되지 않아 문제가 될 수 있다는 단점이 있다.