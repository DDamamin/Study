# Windows API 정복 1권 정리

## Windows

우선 Windows API를 배우기에 앞서 Windows의 역사에 대해 알아보자.
  
윈도우즈는 미국의 마이크로소프트(Microsoft)사에서 만들었다.  
1983년 11월에 개발을 시작하여 그 2년 후인 1985년 11월에 첫 버전을 발표하였다.  
MS-DOS에 비해 멀티 태스킹이 가능했으며 훨씬 더 사용하기 쉽고 예쁜 모양의 그래픽 기반 운영체제(GUI)였다.

1987년 윈도우즈 1.1이 발표되고 같은 해 11월에 윈도우즈 2.0이 발표되었다.  
2.0의 가장 큰 특징으로는 윈도우끼리 겹칠 수 있다는(Overlappped) 점이다. 겹칠 수 있다는 것은 한 번에 여러 개의 작업을 동시에 보면서 진행할 수 있어 진정한 멀티 태스킹을 실현한 것으로 평가할 수 있다. 오버랩 지원으로 인해 운영체제는 훨씬 더 복잡해지고 느려지는 반대 급부를 치러야 했지만 사용 편의성면에서는 큰 개선이 이루어졌다.  
  
2.0버전까지는 오로지 인텔의 8086/8088 CPU에서만 실행되었으며 386에서도 마이크로 프로세서의 진보된 보호모드를 제대로 활용하지 못했다. 그래서 특별히 386의 보호모드를 사용할 수 있는 윈도우즈/386이라는 제품을 따로 발표했으나 이 제품은 곧이어 발표된 윈도우즈 3.0에 의해 가려진다.  
  
1990년 3월 22일에 발표된 윈도우즈 3.0이 발표되었다. 그 2년 후인 1992년에 3.1로 업그레이드되면서 윈도우즈는 그야말로 전성기를 맞이한다.  
대부분의 사람들은 3.1부터 윈도우즈를 사용하기 시작했으며 3.1이야말로 실질적인 윈도우즈의 첫 버전이었다.  
3.1버전에 이르러서 윈도우즈는 보호모드를 지원하고 메모리를 16M가지 사용할 수 있게 되었으며 쉘, 인터페이스 등에 대대적인 혁신이 있었다.  
  
또한 크기 변경이 자유로운 트루 타입 폰트, 공통 대화상자, 복합 문서를 쉽게 만들 수 있는 OLE, 멀티 미디어 등의 새로운 혁신적인 기술들이 대거 추가되었다.  
우리가 윈도우즈를 접한 것은 거의 대부분 윈도우즈 3.1부터이며 그 이전 버전에 대해서는 극히 소수의 사람만 구경해 보았을 뿐이다. 윈도우즈 3.1은 세인들의 깊은 관심속에서 새로운 운영체제로서 상당히 장수를 누렸으며 완전히 한글화된 한글 윈도우즈도 발표되었다.  
  
1995년 8월 윈도우즈 3.1의 다음 버전인 윈도우즈 95가 업계와 사용자들의 지대한 관심 속에서 발표되었다. 95는 16비트의 3.1 버전과는 다르게 차원이 다른 32비트 운영체제로서 PC 환경을 한 단계 높이면서 PC 시장의 대부분을 장악했다. 윈도우즈 95에서 현재의 인터페이스를 거의 확정하였으며 이 인터페이스는 윈도우즈 XP까지 그대로 유지되고 있다. Win32 API 함수들도 대부분 윈도우즈 95에서 확정된 것들이다.  
윈도우즈 95 발표 3년 후에 약간의 기능을 더 추가한 윈도우즈 98이 발표되었고 이후 SE와 ME로 업그레이드되어 더욱 쉬워지고 기능이 강화되었다.  
  
한편 마이크로소프트는 클라이언트용의 윈도우즈 9x라는 시리즈와는 다른 목적으로 서버급의 윈도우즈 NT를 93년 이후 꾸준히 개발해 왔다.  
NT는 처음부터 32비트로 설계되었으며 IBM-PC와의 다른 시스템으로도 이식할 수 있도록 디자인하였다.  
윈도우즈 9x는 주로 클라이언트용의 운영체제로 활용되었으며 NT는 고도의 보안성과 안전성이 요구되는 서버용의 운영체제로 개발되었다.  
NT는 4.0버전에 와서 윈도우즈 95와 똑같은 모습을 가지게 되었으며 윈도우즈 2000에서 대폭적인 기능 향상이 있었다.  
윈도우즈 2000은 9x 계열과 NT 계열을 통합한 첫 번째 버전으로 역사적 의의가 크다.  
  
윈도우즈 2000 이후에 훨씬 더 예쁜 모양으로 단장한 XP가 발표되었고 곧이어 2003이 발표되었다.  
두 버전은 2000에 비해 기능상의 큰 변화는 없으며 제공하는 API도 거의 동일하다.  
XP 다음 버전으로는 비스타(Vista)라는 64비트 운영체제가 발표될 예정이며 비스타는 32비트 버전보다 훨씬 더 고성능을 제공할 것으로 기대된다. (2007년 1월 30일에 개인용이, 기업용은 2006년 11월 30일에 발매되었다.)  
이 외에 모바일 환경을 위한 윈도우즈 CE가 있다.  
  
우리가 윈도우즈의 버전에 대해 알아야 하는 이유는 **버전에 따라 개발 방법과 쓸 수 있는 기술의 종류에 약간의 차이**가 있기 때문이다. 특히 9x 계열과 NT 계열은 많은 차이점이 있다.  
윈도우즈 3.1 이전 버전에 대한 것은 알 필요도 없고 알아봐야 득이 될 것도 없다.

## 특징 및 단점  
  
윈도우즈 이전의 운영체제는 여러 가지가 있지만 일단은 도스(DOS)라고 보는 것이 가장 보편적이다.  
컴퓨터를 배우는 사람들은 누구나 문자 기반의 환경인 도스를 제일 먼저 배웠고 도스에서 파일을 관리하는 방법, 하드 디스크를 포맷하는 방법 등을 익힌 후 윈도우즈 환경으로 넘어 왔었다.  
  
개발자들은 아직까지도 도스 또는 도스 유사 환경인 콘솔에서 프로그래밍에 입문하는 것이 관례이다.  
그래픽 환경은 구조가 복잡하고 덩치가 커서 프로그래밍의 기본 개념을 학습하기에는 적합하지 못하다.  
변수의 개념, 조건 판단, 루프, 자료 구조 등의 기초 프로그래밍 이론은 환경에 상관없이 동일하며 이런 것들은 좀 더 단순환 환경인 도스나 콘솔에서 학습하는 것이 효율적이다.  
아직까지도 윈도우즈 환경에서 프로그래밍을 처음 배우는 사람은 거의 없다.  
도스는 분명 구시대의 유물이며 이제는 사라져도 될 때가 되긴 했지만 그 역사적 위치는 아직도, 어쩌면 영원히 무시하지 못할 것이다.  
  
그래서 여기서는 프로그래밍 입문 환경인 도스 또는 콘솔 환경과 윈도우즈의 차이점 및 특징에 대해 먼저 정리해보기로 한다.  
응용 프로그램을 작성하는 기법을 배우기 전에 응용 프로그램이 실행되는 환경의 특징을 먼저 이해하는 것이 순서상으로도 맞고 이후의 학습을 위해서도 꼭 필요하다.

## 1. 그래픽 기반(GUI)의 운영체제이다.

화면 처리를 문자 단위로 하는 것이 아니라 디지털 표현의 최소 단위인 픽셀(Pixel)로 처리함으로써 섬세한 화면 처리가 가능하다. 그래픽 환경의 장점은 여러 가지가 있겠지만 무엇보다도 프로그램을 예쁘게 만들 수 있다는 점을 꼽을 수 있다. 사람이나 기계나 예뻐서 나쁠 것은 없으니 사용자들은 누구나 예쁜 프로그램을 쓰고 싶어한다.  
  
또한 그래픽 환경은 점 단위로 출력을 제어할 수 있으므로 표현력이 뛰어나서 얼마든지 섬세한 출력을 할 수 있다. 글꼴도 점 단위로 확대할 수 있으며 게임의 캐릭터도 칸 단위가 아닌 점 단위로 움직일 수 있으므로 프로그래머에게 무한한 표현의 자유를 허락한다. 문자 기반의 도스나 콘솔 환경에서 벽돌 깨기 게임이나 그래픽 편집 프로그램을 만드는 것은 불가능하다.

## 2. 멀티 태스킹이 가능하다.

윈도우즈는 한 번에 여러 가지 일을 동시에 수행할 수 있는 멀티 태스킹 운영체제이다. 그래서 한 대의 컴퓨터로 복수 개의 작업을 동시에 실행할 수 있으며 하던 일을 잠시 접어두고 다른 프로그램을 언제든지 실행할 수 있다. 다운로드를 받거나 랜더링을 하거나 컴파일을 하는 동안에도 지루하게 기다릴 필요없이 컴퓨터를 계속 사용할 수 있다는 것은 이전의 운영체제에서는 상상도 할 수 없었던 멋진 기능이다.
  
그러나 멀티 태스킹에 의해 사용자는 편리해졌지만 프로그램은 더욱 복잡해져야 한다. 사실 윈도우즈의 모든 특징들은 멀티 태스킹으로 인해 기인한다. 응용 프로그램은 혼자서 시스템의 모든 자원을 독점할 수 없으며 같이 실행되는 프로그램과 자원을 공평하게 나누어 사용해야 한다. 프로그램은 혼자만 잘 실행되는 것이 최선이 아니며 다른 프로그램과 조화를 이루어야 할 의무도 가진다. 심지어 화면가지도 공유하기 때문에 한 번 출력한 그림도 언제든지 다른 프로그램에 의해 지워질 수 있으며 모든 프로그램은 항상 다시 그릴 준비를 해 두어야 한다.

## 3. 메시지 구동 시스템이다.

멀티 태스킹 환경에서는 프로그램 하나가 시스템의 자원을 독점할 수 없으며 키보드나 마우스 등의 입력 장치도 물론 독점의 대상이 아니다. 그래서 응용 프로그램은 입력 장치로부터 키나 마우스의 입력을 직접 읽을 수 없으며 운영체제가 대신 입력을 받아 전달해 주는 방식을 사용한다. 이때 입력 장치로부터의 입력 신호를 메시지라고 하며 응용 프로그램은 메시지를 받아 동작한다.  
  
이런 동작 방식을 메시지 구동 시스템 또는 이벤트 드리븐 시스템이라고 한다. 모든 프로그램은 운영체제로부터 메시지를 받아 동작하며 프로그램 코드는 메시지를 받았을 때 어떤 처리를 할 것인가를 기술하는 형식이다. 프로그램의 실행순서는 프로그래머가 미리 의도한 대로가 아니라 실행중에 사용자가 프로그램을 조작하는 순서, 즉 발생하는 메시지의 순서를 따른다.

## 4. 장치에 독립적이다.

윈도우즈는 디바이스 드라이버(Device Driver)에 의해 다양한 주변 장치들을 제어하고 관리한다. 그래서 프로그래머들은 사용자의 시스템 구성에는 특별히 신경쓸 필요가 없으며 만들고자 하는 프로그램의 고유 기능 개발에만 열중하면 된다. 장착된 비디오 카드가 무엇이든, 프린터가 어떤 것이 설치되어 있든 프로그램이 달라져야 할 이유가 없다.
  
이런 장치 독립성은 응용 프로그램 개발자들에게 오로지 프로그램 그 자체를 만드는 데만 집중할 수 있도록 하여 생산성을 비약적으로 향상 시켰다. 과거에 프로그래머가 직접 했던 많은 잡스러운 일들을 운영체제가 대신 하므로 시간적, 금전적으로 엄청난 비용을 절감하게 되었다.
  
장치 독립성은 개발자 뿐만 아니라 사용자, 하드웨어 제작사 등에도 많은 이익을 가져다 주었다. 사용자는 자신이 사용하는 프로그램의 종류에 상관없이 하드웨어를 자유롭게 선택할 수 있다. 하드웨어 제작사는 디바이스 드라이버만 제공하면 어떤 프로그램과도 잘 동작하는 하드웨어를 쉽게 개발할 수 있게 되었다. 운영체제가 많은 일을 하게 되면 응용 프로그램이 할 일을 그만큼 줄어든다.

## 5. 일관성이 있다.

사용자가 프로그램에게 명령을 내리는 인터페이스 구성이 표준화되어 있다. 대표적으로 파일 열기 대화상자나 글꼴 선택 대화상자 등을 들 수 있으며 메뉴나 툴 바도 운영체제가 직접 지원한다. 응용 프로그램 개발자들은 일너 인터페이스를 구현하기 위한 중복 투자를 할 필요없이 운영체제가 제공하는 표준 인터페이스를 활용하기만 하면 된다.
  
사용자 입장에서도 이런 인터페이스 사용법을 한 번만 제대로 익혀 두면 어떤 프로그램이나 유사한 방법으로 사용할 수 있어 복잡한 프로그램도 쉽고 빠르게 배워 활용할 수 있다. 대화상자에서 일을 선택하는 방법이나 메뉴에서 원하는 명령을 고르는 방법이 프로그램마다 다르지 않고 통일되어 있다.

## 6. 리소스가 분리되어 있다.

리소스(Resource)란 코드(Code)의 반대 의미로 프로그램에서 필요로 하는 여러 가지 데이터를 말한며 메뉴, 비트맵, 아이콘 등등이 리소스의 예다. 윈도우즈 응용 프로그램은 코드와 리소스가 분리되어 있어 개발자와 디자이너가 분담 작업을 쉽게 할 수 있다. 윈도우즈에서는 이런 여러 가지 자원들을 리소스로 정의한 후 최종 실행 파일에 합치며 별도의 리소스 편집기로 비주얼하게 편집할 수 있어 여러 모로 프로그램 개발 과정이 편래해졌다.
  
이런 대표적인 장점들 외에도 윈도우즈는 아주 많은 장점들을 가지고 있다. 능적인 이런 장점들 외에 가장 중요한 것은 현재까지 발표된 어떤 운영체제보다도 많은 사용자를 확보하고 있다는 대중성을 들 수 있다. 서버 시장에서는 아직 경쟁중이지만 데스크 탑 시장은 거의 완벽하게 장악했으며 위협이 될만한 경쟁 제품조차도 없는 상황이다. 많은 사람들이 사용한다는 것은 그만큼 시장이 넓고 따라서 무수히 많은 소프트웨어를 필요로 하며 고급 프로그래머에 대한 수요가 많다는 뜻이다. 즉 경제성이 높다는 뜻이다.
  
물론 단점들도 많은데 안정성이나 속도에 있어서는 불만의 목소리도 높으며 제작사으이 독점적인 경영 형태는 비난의 대상이 되기도 한다. 운영체제의 순수한 기능만을 놓고 다진다면 사실 윈도우즈보다 훨씬 더 뛰어난 운영체제도 많이 있으며 특정 분야에서는 윈도우즈를 압도하는 것들도 있다. 하지만 아무리 기능이 우수해도 소수의 몇몇 사람만 사용한다면 개바자로서 매력을 느끼기 어려울 것이다. 이는 비단 경제적인 문제에만 국한되는 것이 아닌데 아무도 쓰지 않는 프로그램은 만들 의욕이 생기지 않는 법이다.